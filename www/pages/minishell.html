<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Minishell - webserv</title>
	<link rel="stylesheet" href="../style.css">
</head>
<body>
	<div class="container">
		<h1>Minishell</h1>
		<div class="terminal" id="output">
			Welcome to webserv minishell...
		</div>
		<form class="command-form" action="/cgi-bin/minishell" method="POST">
			<input type="text" name="command" placeholder="Enter command..." required>
			<button type="submit">Run</button>
		</form>
		<nav>
			<ul class="nav-links">
				<li><a href="/">Back</a></li>
			</ul>
		</nav>
	</div>
	<script>
		document.querySelector('.command-form').addEventListener('submit', async (e) => {
			e.preventDefault();
			const command = e.target.command.value;
			const output = document.getElementById('output');
			
			try {
				const response = await fetch('/cgi-bin/minishell', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/x-www-form-urlencoded',
					},
					body: `command=${encodeURIComponent(command)}`
				});
				const result = await response.text();
				output.innerHTML += `\n$ ${command}\n${result}`;
			} catch (error) {
				output.innerHTML += `\nError: ${error.message}\n`;
			}
			
			e.target.command.value = '';
		});
	</script>
</body>
</html>
